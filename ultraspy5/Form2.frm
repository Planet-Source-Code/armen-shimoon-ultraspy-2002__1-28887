VERSION 5.00
Begin VB.Form frmSC 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Generated Subclassing Code"
   ClientHeight    =   4455
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   6435
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form2"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4455
   ScaleWidth      =   6435
   StartUpPosition =   3  'Windows Default
   Begin VB.CommandButton Command1 
      Caption         =   "Copy Code"
      Height          =   555
      Left            =   4680
      TabIndex        =   3
      Top             =   3780
      Width           =   1635
   End
   Begin VB.CommandButton cmdClose 
      Caption         =   "&Close"
      Height          =   555
      Left            =   1620
      TabIndex        =   2
      Top             =   3780
      Width           =   1455
   End
   Begin VB.CommandButton cmdGen 
      Caption         =   "&Generate"
      Height          =   555
      Left            =   90
      TabIndex        =   1
      Top             =   3780
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Height          =   3525
      Left            =   90
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   0
      Top             =   90
      Width           =   6225
   End
End
Attribute VB_Name = "frmSC"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim MainCode As String



Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long



Private Sub cmdClose_Click()
Unload Me
End Sub



Private Sub cmdGen_Click()


If Form1.txtParent.Text = "0" Then
    Call FinishMake(Form1.txtClass.Text, Form1.txtUM.Text)
End If
If Form1.txtParent.Text <> "0" Then
    Call FinishMake2(Form1.txtPClass.Text, Form1.txtPText.Text, Form1.txtClass.Text, Form1.txtUM.Text)
End If




End Sub

Private Sub Command1_Click()
Clipboard.Clear
Clipboard.SetText Text1.Text
End Sub

Private Sub Form_Load()
Me.Icon = LoadResPicture(101, vbResIcon)
End Sub



Private Function MakeCode()


End Function




Public Function FinishMake(classname As String, windowname As String)
    Text1.Text = ""
    Text1.SetFocus
    
    SendKeys "'SUBCLASSING CODE GENERATED BY SHIMOON ULTRASPY V5.0"
    SendKeys vbCrLf
    SendKeys vbCr
    SendKeys "'All you have to do is call OnAppLoad() from a button or form_load event in your code."
    SendKeys vbCrLf
    SendKeys "'***************************************"
    SendKeys vbCr
    SendKeys "'*PASTE INTO MODULE*"
    SendKeys vbCr
    SendKeys "'***************************************"
    SendKeys vbCrLf
    SendKeys "{ENTER}"
    SendKeys "Public Declare Function GetWindowLong Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "GetWindowLongA" & Chr(34) & " {(}ByVal hwnd As Long, ByVal nIndex As Long{)} As Long"
    SendKeys "{ENTER}"
    SendKeys "Public Declare Function SetWindowLong Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "SetWindowLongA" & Chr(34) & " {(}ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long{)} As Long"
    SendKeys "{ENTER}"
    SendKeys "Public Declare Function CallWindowProc Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "CallWindowProcA" & Chr(34) & " {(}ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal Msg As Long, ByVal wParam As Long, ByVal lParam As Long{)} As Long"
    SendKeys "{ENTER}"
    SendKeys "Public Declare Function FindWindow Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "FindWindowA" & Chr(34) & " {(}ByVal lpClassName As String, ByVal lpWindowName As String{)} As Long"
    SendKeys "{ENTER}"
    SendKeys "Public Const GWL_WNDPROC = (-4)"
    SendKeys "{ENTER}"
    SendKeys "Public Const WM_LBUTTONUP = &H202"
    SendKeys "{ENTER}"
    SendKeys "Dim OldWindowProc As Long"
    SendKeys "{ENTER}"
    SendKeys "{ENTER}"
    SendKeys "Public Sub OnAppLoad{(}{)}"
    SendKeys "{ENTER}"
    SendKeys "Dim WindowHandle As Long"
    SendKeys "{ENTER}"
    SendKeys "WindowHandle = FindWindow{(}vbNullString," & Chr(34) & windowname & Chr(34) & "{)}"
    SendKeys "{ENTER}"
    SendKeys "OldWindowProc = GetWindowLong{(}WindowHandle, GWL_WNDPROC{)}"
    SendKeys "{ENTER}"
    SendKeys "Call SetWindowLong{(}WindowHandle, GWL_WNDPROC, GetAddress{(}AddressOf NewWindowProc{)}{)}"
    SendKeys "{ENTER}"
    SendKeys "End Sub"
    SendKeys "{ENTER}"
    SendKeys vbCr
    SendKeys "Public Function NewWindowProc{(}ByVal hwnd As Long, ByVal uMsg As Long, ByVal wParam As Long, ByVal lParam As Long{)} As Long"
    SendKeys vbCr
    SendKeys "Select Case uMsg&"
    SendKeys vbCr
    SendKeys "    Case WM_LBUTTONUP:"
    SendKeys vbCr
    SendKeys "        'TODO - ADD LEFT BUTTON UP HANDLING CODE"
    SendKeys vbCr
    SendKeys "     End Select"
    SendKeys vbCr
    SendKeys "Call CallWindowProc{(}OldWindowProc, hwnd&, uMsg&, wpram&, lParam&{)}"
    SendKeys vbCr
    SendKeys "End Function"
    SendKeys vbCr
    SendKeys vbCr
    SendKeys "Public Function GetAddress{(}Byval lAddr As Long{)} As Long"
    SendKeys vbCr
    SendKeys "GetAddress = lAddr&"
    SendKeys vbCr
    SendKeys "End Function"
End Function



Public Function FinishMake2(parentclass As String, parenttext As String, windowclass As String, windowtext As String)
    Text1.Text = ""
    Text1.SetFocus

    SendKeys "'SUBCLASSING CODE GENERATED BY SHIMOON ULTRASPY V5.0"
    SendKeys vbCrLf
    SendKeys vbCr
    SendKeys "'All you have to do is call OnAppLoad() from a button or form_load event in your code."
    SendKeys vbCrLf
    SendKeys "'***************************************"
    SendKeys vbCr
    SendKeys "'*PASTE INTO MODULE*"
    SendKeys vbCr
    SendKeys "'***************************************"
    SendKeys vbCrLf

SendKeys vbCr
SendKeys "Public Declare Function GetWindowLong Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "GetWindowLongA" & Chr(34) & " {(}ByVal hwnd As Long, ByVal nIndex As Long{)} As Long"
SendKeys vbCr
SendKeys "Public Declare Function SetWindowLong Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "SetWindowLongA" & Chr(34) & " {(}ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long{)} As Long"
SendKeys vbCr
SendKeys "Public Declare Function CallWindowProc Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "CallWindowProcA" & Chr(34) & " {(}ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal Msg As Long, ByVal wParam As Long, ByVal lParam As Long{)} As Long"
SendKeys vbCr
SendKeys "Public Declare Function FindWindow Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "FindWindowA" & Chr(34) & " {(}ByVal lpClassName As String, ByVal lpWindowName As String{)} As Long"
SendKeys vbCr
SendKeys "Public Declare Function FindWindowEx Lib " & Chr(34) & "user32" & Chr(34) & " Alias " & Chr(34) & "FindWindowExA" & Chr(34) & " {(}ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String{)} As Long"
SendKeys vbCr
SendKeys "Public Const GWL_WNDPROC = (-4)"
SendKeys vbCr
SendKeys "Public Const WM_LBUTTONUP = &H202"
SendKeys vbCr
SendKeys "Dim OldWindowProc As Long"
SendKeys vbCr
SendKeys vbCr
SendKeys "Public Sub OnAppLoad{(}{)}"
SendKeys vbCr
SendKeys "Dim WindowHandle As Long"
SendKeys vbCr
SendKeys "Dim ParentHandle As Long"
SendKeys vbCrLf
SendKeys "ParentHandle = FindWindow{(}vbNullString," & Chr(34) & parenttext & Chr(34) & "{)}"
SendKeys vbCr
SendKeys "WindowHandle = FindWindowEx{(}ParentHandle, 0, vbNullString," & Chr(34) & windowtext & Chr(34) & "{)}"
SendKeys vbCr
SendKeys "OldWindowProc = GetWindowLong{(}WindowHandle, GWL_WNDPROC{)}"
SendKeys vbCr
SendKeys "Call SetWindowLong{(}WindowHandle, GWL_WNDPROC, GetAddress{(}AddressOf NewWindowProc{)}{)}"
SendKeys vbCr
SendKeys "End Sub"
SendKeys vbCr
SendKeys vbCr
SendKeys "Public Function NewWindowProc{(}ByVal hwnd As Long, ByVal uMsg As Long, ByVal wParam As Long, ByVal lParam As Long{)} As Long"
SendKeys vbCr
SendKeys "Select Case uMsg&"
SendKeys vbCr
SendKeys "    Case WM_LBUTTONUP:"
SendKeys vbCr
SendKeys "        'TODO - ADD LEFT BUTTON UP HANDLING CODE"
SendKeys vbCr
SendKeys "     End Select"
SendKeys vbCr
SendKeys "Call CallWindowProc{(}OldWindowProc, hwnd&, uMsg&, wpram&, lParam&{)}"
SendKeys vbCr
SendKeys "End Function"
SendKeys vbCr
SendKeys vbCr
SendKeys "Public Function GetAddress{(}Byval lAddr As Long{)} As Long"
SendKeys vbCr
SendKeys "GetAddress = lAddr&"
SendKeys vbCr
SendKeys "End Function"
End Function

